ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"Timer.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.CaptureInit,"ax",%progbits
  16              		.align	1
  17              		.global	CaptureInit
  18              		.arch armv7-m
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	CaptureInit:
  25              	.LFB65:
  26              		.file 1 "HARDWARE/Timer.c"
   1:HARDWARE/Timer.c **** #include "Timer.h"
   2:HARDWARE/Timer.c **** 
   3:HARDWARE/Timer.c **** _Capture Capture;
   4:HARDWARE/Timer.c **** 
   5:HARDWARE/Timer.c **** void CaptureInit(void) {
  27              		.loc 1 5 24 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 30B5     		push	{r4, r5, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 12
  34              		.cfi_offset 4, -12
  35              		.cfi_offset 5, -8
  36              		.cfi_offset 14, -4
  37 0002 83B0     		sub	sp, sp, #12
  38              	.LCFI1:
  39              		.cfi_def_cfa_offset 24
   6:HARDWARE/Timer.c **** 	RCC->APB1ENR |= 0x02;		//使能TIM3时钟
  40              		.loc 1 6 2 view .LVU1
  41              		.loc 1 6 15 is_stmt 0 view .LVU2
  42 0004 204B     		ldr	r3, .L3
  43 0006 5A6A     		ldr	r2, [r3, #36]
  44 0008 42F00202 		orr	r2, r2, #2
  45 000c 5A62     		str	r2, [r3, #36]
   7:HARDWARE/Timer.c **** 	RCC->AHBENR |= 0x02;		//PB时钟
  46              		.loc 1 7 2 is_stmt 1 view .LVU3
  47              		.loc 1 7 14 is_stmt 0 view .LVU4
  48 000e DA69     		ldr	r2, [r3, #28]
  49 0010 42F00202 		orr	r2, r2, #2
  50 0014 DA61     		str	r2, [r3, #28]
   8:HARDWARE/Timer.c **** //	GPIO_Set(GPIOB, PIN0 | PIN1, GPIO_MODE_AF, GPIO_OTYPE_PP, GPIO_SPEED_100M,GPIO_PUPD_PD);
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 2


   9:HARDWARE/Timer.c **** 	GPIO_Set(GPIOB, PIN1, GPIO_MODE_AF, GPIO_OTYPE_PP, GPIO_SPEED_100M,GPIO_PUPD_PD);
  51              		.loc 1 9 2 is_stmt 1 view .LVU5
  52 0016 1D4D     		ldr	r5, .L3+4
  53 0018 0224     		movs	r4, #2
  54 001a 0194     		str	r4, [sp, #4]
  55 001c 0323     		movs	r3, #3
  56 001e 0093     		str	r3, [sp]
  57 0020 0023     		movs	r3, #0
  58 0022 2246     		mov	r2, r4
  59 0024 2146     		mov	r1, r4
  60 0026 2846     		mov	r0, r5
  61 0028 FFF7FEFF 		bl	GPIO_Set
  62              	.LVL0:
  10:HARDWARE/Timer.c **** //	GPIO_AF_Set(GPIOB, 0, 2);		//PB0,AF2
  11:HARDWARE/Timer.c **** 	GPIO_AF_Set(GPIOB, 1, 2);		//PB1,AF2
  63              		.loc 1 11 2 view .LVU6
  64 002c 2246     		mov	r2, r4
  65 002e 0121     		movs	r1, #1
  66 0030 2846     		mov	r0, r5
  67 0032 FFF7FEFF 		bl	GPIO_AF_Set
  68              	.LVL1:
  12:HARDWARE/Timer.c **** 
  13:HARDWARE/Timer.c **** 	TIM3->ARR = 0xFFFF;  			//最大值65535   
  69              		.loc 1 13 2 view .LVU7
  70              		.loc 1 13 12 is_stmt 0 view .LVU8
  71 0036 164C     		ldr	r4, .L3+8
  72 0038 4FF6FF73 		movw	r3, #65535
  73 003c E362     		str	r3, [r4, #44]
  14:HARDWARE/Timer.c **** 	TIM3->PSC = 3199;  				//频率1K 
  74              		.loc 1 14 2 is_stmt 1 view .LVU9
  75              		.loc 1 14 12 is_stmt 0 view .LVU10
  76 003e 40F67F43 		movw	r3, #3199
  77 0042 A362     		str	r3, [r4, #40]
  15:HARDWARE/Timer.c **** 
  16:HARDWARE/Timer.c **** 	TIM3->SMCR |= 0x100;			//
  78              		.loc 1 16 2 is_stmt 1 view .LVU11
  79              		.loc 1 16 13 is_stmt 0 view .LVU12
  80 0044 A368     		ldr	r3, [r4, #8]
  81 0046 43F48073 		orr	r3, r3, #256
  82 004a A360     		str	r3, [r4, #8]
  17:HARDWARE/Timer.c **** 	TIM3->CCMR2 |= 0x101;
  83              		.loc 1 17 2 is_stmt 1 view .LVU13
  84              		.loc 1 17 14 is_stmt 0 view .LVU14
  85 004c E369     		ldr	r3, [r4, #28]
  86 004e 43F48073 		orr	r3, r3, #256
  87 0052 43F00103 		orr	r3, r3, #1
  88 0056 E361     		str	r3, [r4, #28]
  18:HARDWARE/Timer.c **** 	TIM3->CCER |= 0x1100;
  89              		.loc 1 18 2 is_stmt 1 view .LVU15
  90              		.loc 1 18 13 is_stmt 0 view .LVU16
  91 0058 236A     		ldr	r3, [r4, #32]
  92 005a 43F48853 		orr	r3, r3, #4352
  93 005e 2362     		str	r3, [r4, #32]
  19:HARDWARE/Timer.c **** 	TIM3->EGR = 1 << 0;	
  94              		.loc 1 19 2 is_stmt 1 view .LVU17
  95              		.loc 1 19 12 is_stmt 0 view .LVU18
  96 0060 0121     		movs	r1, #1
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 3


  97 0062 6161     		str	r1, [r4, #20]
  20:HARDWARE/Timer.c **** 	TIM3->DIER |= (0x01 << 4);   	//通道4	
  98              		.loc 1 20 2 is_stmt 1 view .LVU19
  99              		.loc 1 20 13 is_stmt 0 view .LVU20
 100 0064 E368     		ldr	r3, [r4, #12]
 101 0066 43F01003 		orr	r3, r3, #16
 102 006a E360     		str	r3, [r4, #12]
  21:HARDWARE/Timer.c **** 	TIM3->DIER |= 1;   				
 103              		.loc 1 21 2 is_stmt 1 view .LVU21
 104              		.loc 1 21 13 is_stmt 0 view .LVU22
 105 006c E368     		ldr	r3, [r4, #12]
 106 006e 0B43     		orrs	r3, r3, r1
 107 0070 E360     		str	r3, [r4, #12]
  22:HARDWARE/Timer.c **** 	MY_NVIC_Init(0, 1, TIM3_IRQn, 0);
 108              		.loc 1 22 2 is_stmt 1 view .LVU23
 109 0072 0023     		movs	r3, #0
 110 0074 1D22     		movs	r2, #29
 111 0076 1846     		mov	r0, r3
 112 0078 FFF7FEFF 		bl	MY_NVIC_Init
 113              	.LVL2:
  23:HARDWARE/Timer.c **** 	TIM3->CR1 |= 0x01;    			//使能定时器
 114              		.loc 1 23 2 view .LVU24
 115              		.loc 1 23 12 is_stmt 0 view .LVU25
 116 007c 2368     		ldr	r3, [r4]
 117 007e 43F00103 		orr	r3, r3, #1
 118 0082 2360     		str	r3, [r4]
  24:HARDWARE/Timer.c **** }
 119              		.loc 1 24 1 view .LVU26
 120 0084 03B0     		add	sp, sp, #12
 121              	.LCFI2:
 122              		.cfi_def_cfa_offset 12
 123              		@ sp needed
 124 0086 30BD     		pop	{r4, r5, pc}
 125              	.L4:
 126              		.align	2
 127              	.L3:
 128 0088 00380240 		.word	1073887232
 129 008c 00040240 		.word	1073873920
 130 0090 00040040 		.word	1073742848
 131              		.cfi_endproc
 132              	.LFE65:
 134              		.section	.text.TIM3_IRQHandler,"ax",%progbits
 135              		.align	1
 136              		.global	TIM3_IRQHandler
 137              		.syntax unified
 138              		.thumb
 139              		.thumb_func
 140              		.fpu softvfp
 142              	TIM3_IRQHandler:
 143              	.LFB66:
  25:HARDWARE/Timer.c **** 
  26:HARDWARE/Timer.c **** void TIM3_IRQHandler(void) {
 144              		.loc 1 26 28 is_stmt 1 view -0
 145              		.cfi_startproc
 146              		@ args = 0, pretend = 0, frame = 0
 147              		@ frame_needed = 0, uses_anonymous_args = 0
 148              		@ link register save eliminated.
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 4


  27:HARDWARE/Timer.c **** 	_CapCh* CapCh;
 149              		.loc 1 27 2 view .LVU28
  28:HARDWARE/Timer.c **** 	u8 sr = TIM3->SR & 0xFF;
 150              		.loc 1 28 2 view .LVU29
 151              		.loc 1 28 14 is_stmt 0 view .LVU30
 152 0000 194B     		ldr	r3, .L10
 153 0002 1B69     		ldr	r3, [r3, #16]
 154              	.LVL3:
  29:HARDWARE/Timer.c **** 	if (sr & 0x10) {
 155              		.loc 1 29 2 is_stmt 1 view .LVU31
 156              		.loc 1 29 5 is_stmt 0 view .LVU32
 157 0004 13F0100F 		tst	r3, #16
 158 0008 08D0     		beq	.L6
  30:HARDWARE/Timer.c **** 		CapCh = &Capture.CAP2_FFN;
 159              		.loc 1 30 3 is_stmt 1 view .LVU33
 160              	.LVL4:
  31:HARDWARE/Timer.c **** 		if (!CapCh->FirstFlag)			//第一次捕获到上升沿
 161              		.loc 1 31 3 view .LVU34
 162              		.loc 1 31 13 is_stmt 0 view .LVU35
 163 000a 184B     		ldr	r3, .L10+4
 164              	.LVL5:
 165              		.loc 1 31 13 view .LVU36
 166 000c 9B7A     		ldrb	r3, [r3, #10]	@ zero_extendqisi2
 167              		.loc 1 31 6 view .LVU37
 168 000e 5BB9     		cbnz	r3, .L7
  32:HARDWARE/Timer.c **** 		{
  33:HARDWARE/Timer.c **** 			CapCh->FirstFlag = 1;
 169              		.loc 1 33 4 is_stmt 1 view .LVU38
 170              		.loc 1 33 21 is_stmt 0 view .LVU39
 171 0010 164B     		ldr	r3, .L10+4
 172 0012 0122     		movs	r2, #1
 173 0014 9A72     		strb	r2, [r3, #10]
  34:HARDWARE/Timer.c **** 			CapCh->Cnt1 = TIM3->CCR4;
 174              		.loc 1 34 4 is_stmt 1 view .LVU40
 175              		.loc 1 34 22 is_stmt 0 view .LVU41
 176 0016 144A     		ldr	r2, .L10
 177 0018 126C     		ldr	r2, [r2, #64]
 178              		.loc 1 34 16 view .LVU42
 179 001a 9A81     		strh	r2, [r3, #12]	@ movhi
 180              	.LVL6:
 181              	.L6:
  35:HARDWARE/Timer.c **** 		} else							//第二次捕获到上升沿
  36:HARDWARE/Timer.c **** 		{
  37:HARDWARE/Timer.c **** 			CapCh->FirstFlag = 0;
  38:HARDWARE/Timer.c **** 			CapCh->Cnt2 = TIM3->CCR4;
  39:HARDWARE/Timer.c **** 			if (CapCh->Cnt2 >= CapCh->Cnt1)	//计算两个上升沿时间差			
  40:HARDWARE/Timer.c **** 				CapCh->TimDiff = (CapCh->Cnt2 - CapCh->Cnt1);
  41:HARDWARE/Timer.c **** 			else
  42:HARDWARE/Timer.c **** 				CapCh->TimDiff = 0xFFFF + (CapCh->Cnt2 - CapCh->Cnt1);
  43:HARDWARE/Timer.c **** 			CapCh->Freq = ((10000 / CapCh->TimDiff)>>1);
  44:HARDWARE/Timer.c **** 			Freq.Status = FREQCAPED;
  45:HARDWARE/Timer.c **** 		}
  46:HARDWARE/Timer.c **** 	}
  47:HARDWARE/Timer.c **** 	TIM3->SR &= 0xFE;
 182              		.loc 1 47 2 is_stmt 1 view .LVU43
 183              		.loc 1 47 11 is_stmt 0 view .LVU44
 184 001c 124A     		ldr	r2, .L10
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 5


 185 001e 1369     		ldr	r3, [r2, #16]
 186 0020 03F0FE03 		and	r3, r3, #254
 187 0024 1361     		str	r3, [r2, #16]
  48:HARDWARE/Timer.c **** }
 188              		.loc 1 48 1 view .LVU45
 189 0026 7047     		bx	lr
 190              	.LVL7:
 191              	.L7:
  37:HARDWARE/Timer.c **** 			CapCh->Cnt2 = TIM3->CCR4;
 192              		.loc 1 37 4 is_stmt 1 view .LVU46
  37:HARDWARE/Timer.c **** 			CapCh->Cnt2 = TIM3->CCR4;
 193              		.loc 1 37 21 is_stmt 0 view .LVU47
 194 0028 104A     		ldr	r2, .L10+4
 195 002a 0023     		movs	r3, #0
 196 002c 9372     		strb	r3, [r2, #10]
  38:HARDWARE/Timer.c **** 			if (CapCh->Cnt2 >= CapCh->Cnt1)	//计算两个上升沿时间差			
 197              		.loc 1 38 4 is_stmt 1 view .LVU48
  38:HARDWARE/Timer.c **** 			if (CapCh->Cnt2 >= CapCh->Cnt1)	//计算两个上升沿时间差			
 198              		.loc 1 38 22 is_stmt 0 view .LVU49
 199 002e 0E4B     		ldr	r3, .L10
 200 0030 1B6C     		ldr	r3, [r3, #64]
  38:HARDWARE/Timer.c **** 			if (CapCh->Cnt2 >= CapCh->Cnt1)	//计算两个上升沿时间差			
 201              		.loc 1 38 16 view .LVU50
 202 0032 9BB2     		uxth	r3, r3
 203 0034 D381     		strh	r3, [r2, #14]	@ movhi
  39:HARDWARE/Timer.c **** 				CapCh->TimDiff = (CapCh->Cnt2 - CapCh->Cnt1);
 204              		.loc 1 39 4 is_stmt 1 view .LVU51
  39:HARDWARE/Timer.c **** 				CapCh->TimDiff = (CapCh->Cnt2 - CapCh->Cnt1);
 205              		.loc 1 39 28 is_stmt 0 view .LVU52
 206 0036 9289     		ldrh	r2, [r2, #12]
  39:HARDWARE/Timer.c **** 				CapCh->TimDiff = (CapCh->Cnt2 - CapCh->Cnt1);
 207              		.loc 1 39 7 view .LVU53
 208 0038 9342     		cmp	r3, r2
 209 003a 0ED3     		bcc	.L8
  40:HARDWARE/Timer.c **** 			else
 210              		.loc 1 40 5 is_stmt 1 view .LVU54
  40:HARDWARE/Timer.c **** 			else
 211              		.loc 1 40 35 is_stmt 0 view .LVU55
 212 003c 9B1A     		subs	r3, r3, r2
  40:HARDWARE/Timer.c **** 			else
 213              		.loc 1 40 20 view .LVU56
 214 003e 0B4A     		ldr	r2, .L10+4
 215 0040 1382     		strh	r3, [r2, #16]	@ movhi
 216              	.L9:
  43:HARDWARE/Timer.c **** 			Freq.Status = FREQCAPED;
 217              		.loc 1 43 4 is_stmt 1 view .LVU57
  43:HARDWARE/Timer.c **** 			Freq.Status = FREQCAPED;
 218              		.loc 1 43 33 is_stmt 0 view .LVU58
 219 0042 0A4A     		ldr	r2, .L10+4
 220 0044 118A     		ldrh	r1, [r2, #16]
  43:HARDWARE/Timer.c **** 			Freq.Status = FREQCAPED;
 221              		.loc 1 43 26 view .LVU59
 222 0046 42F21073 		movw	r3, #10000
 223 004a 93FBF1F3 		sdiv	r3, r3, r1
  43:HARDWARE/Timer.c **** 			Freq.Status = FREQCAPED;
 224              		.loc 1 43 43 view .LVU60
 225 004e 5B10     		asrs	r3, r3, #1
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 6


  43:HARDWARE/Timer.c **** 			Freq.Status = FREQCAPED;
 226              		.loc 1 43 16 view .LVU61
 227 0050 5382     		strh	r3, [r2, #18]	@ movhi
  44:HARDWARE/Timer.c **** 		}
 228              		.loc 1 44 4 is_stmt 1 view .LVU62
  44:HARDWARE/Timer.c **** 		}
 229              		.loc 1 44 16 is_stmt 0 view .LVU63
 230 0052 074B     		ldr	r3, .L10+8
 231 0054 0222     		movs	r2, #2
 232 0056 1A70     		strb	r2, [r3]
 233 0058 E0E7     		b	.L6
 234              	.L8:
  42:HARDWARE/Timer.c **** 			CapCh->Freq = ((10000 / CapCh->TimDiff)>>1);
 235              		.loc 1 42 5 is_stmt 1 view .LVU64
  42:HARDWARE/Timer.c **** 			CapCh->Freq = ((10000 / CapCh->TimDiff)>>1);
 236              		.loc 1 42 44 is_stmt 0 view .LVU65
 237 005a 9B1A     		subs	r3, r3, r2
 238 005c 9BB2     		uxth	r3, r3
  42:HARDWARE/Timer.c **** 			CapCh->Freq = ((10000 / CapCh->TimDiff)>>1);
 239              		.loc 1 42 29 view .LVU66
 240 005e 013B     		subs	r3, r3, #1
  42:HARDWARE/Timer.c **** 			CapCh->Freq = ((10000 / CapCh->TimDiff)>>1);
 241              		.loc 1 42 20 view .LVU67
 242 0060 024A     		ldr	r2, .L10+4
 243 0062 1382     		strh	r3, [r2, #16]	@ movhi
 244 0064 EDE7     		b	.L9
 245              	.L11:
 246 0066 00BF     		.align	2
 247              	.L10:
 248 0068 00040040 		.word	1073742848
 249 006c 00000000 		.word	Capture
 250 0070 00000000 		.word	Freq
 251              		.cfi_endproc
 252              	.LFE66:
 254              		.comm	Capture,20,4
 255              		.text
 256              	.Letext0:
 257              		.file 2 "/Users/shuuyou/gcc-arm-none-eabi/arm-none-eabi/include/machine/_default_types.h"
 258              		.file 3 "/Users/shuuyou/gcc-arm-none-eabi/arm-none-eabi/include/sys/_stdint.h"
 259              		.file 4 "Inc/stm32l152xe.h"
 260              		.file 5 "/Users/shuuyou/gcc-arm-none-eabi/lib/gcc/arm-none-eabi/8.3.1/include/stddef.h"
 261              		.file 6 "/Users/shuuyou/gcc-arm-none-eabi/arm-none-eabi/include/sys/_types.h"
 262              		.file 7 "/Users/shuuyou/gcc-arm-none-eabi/arm-none-eabi/include/sys/reent.h"
 263              		.file 8 "/Users/shuuyou/gcc-arm-none-eabi/arm-none-eabi/include/sys/lock.h"
 264              		.file 9 "Inc/core_cm3.h"
 265              		.file 10 "APP/inc/Public.h"
 266              		.file 11 "RML1028B/RML1028B.h"
 267              		.file 12 "HARDWARE/inc/Temputer.h"
 268              		.file 13 "HARDWARE/inc/Adc.h"
 269              		.file 14 "HARDWARE/inc/Control.h"
 270              		.file 15 "TOOL/inc/malloc.h"
 271              		.file 16 "TOOL/inc/TaskManger.h"
 272              		.file 17 "DISPALY/inc/DispManger.h"
 273              		.file 18 "TOOL/inc/CrcUtil.h"
 274              		.file 19 "APP/inc/VolPro.h"
 275              		.file 20 "APP/inc/FreqPro.h"
 276              		.file 21 "APP/inc/ParasCheckPro.h"
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 7


 277              		.file 22 "APP/inc/TemputerPro.h"
 278              		.file 23 "HARDWARE/inc/Timer.h"
 279              		.file 24 "HARDWARE/inc/Mcu.h"
ARM GAS  /var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s 			page 8


DEFINED SYMBOLS
                            *ABS*:0000000000000000 Timer.c
/var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s:16     .text.CaptureInit:0000000000000000 $t
/var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s:24     .text.CaptureInit:0000000000000000 CaptureInit
/var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s:128    .text.CaptureInit:0000000000000088 $d
/var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s:135    .text.TIM3_IRQHandler:0000000000000000 $t
/var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s:142    .text.TIM3_IRQHandler:0000000000000000 TIM3_IRQHandler
/var/folders/ww/n4ctlbrs3x70633t9y2ks63c0000gn/T//cc0MpmT4.s:248    .text.TIM3_IRQHandler:0000000000000068 $d
                            *COM*:0000000000000014 Capture

UNDEFINED SYMBOLS
GPIO_Set
GPIO_AF_Set
MY_NVIC_Init
Freq
